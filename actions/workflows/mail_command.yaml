---
chain:
    -
        name: "search_host"
        ref: "st2.kv.get_object"
        parameters:
            key: "{{ node }}"
        on-success: "parse_command"
        on-failure: "search_failed"
    -
        name: "parse_command"
        ref: "email_command.split_text"
        parameters:
            text: "{{ command_text }}"
    -
        name: "search_failed"
        ref: "core.sendmail"
        parameters:
            from: "stackstorm@fixpoint.co.jp"
            to: "{{ reply_to }}"
            subject: "failed to search host: {{ node }}"
            body: "{{ node }} is unregistered host"
default: "search_host"
